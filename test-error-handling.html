<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Error Handling Test</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/portfolio.css">
    <style>
        .test-section {
            background: #1E1E1E;
            padding: 2rem;
            margin: 2rem;
            border-radius: 8px;
            border: 1px solid #333;
        }
        
        .test-section h2 {
            color: #BFA46F;
            margin-bottom: 1rem;
            font-family: 'Bebas Neue Pro', sans-serif;
        }
        
        .test-button {
            background: #A70000;
            color: #F5F3F0;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            margin: 0.5rem;
            font-weight: 500;
            transition: all 200ms ease-out;
        }
        
        .test-button:hover {
            background: #C70000;
            transform: translateY(-2px);
        }
        
        .test-results {
            background: #0B0B0B;
            padding: 1rem;
            border-radius: 4px;
            margin-top: 1rem;
            font-family: monospace;
            font-size: 0.9rem;
            color: #ccc;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 style="color: #BFA46F; text-align: center; padding: 2rem; font-family: 'Bebas Neue Pro', sans-serif;">Portfolio Error Handling Tests</h1>
        
        <!-- Test 404 Error -->
        <div class="test-section">
            <h2>404 Error Test</h2>
            <p style="color: #ccc; margin-bottom: 1rem;">Test invalid artist portfolio URL handling</p>
            <button class="test-button" onclick="test404Error()">Trigger 404 Error</button>
            <div id="test-404-results" class="test-results"></div>
        </div>
        
        <!-- Test Image Loading Error -->
        <div class="test-section">
            <h2>Image Loading Error Test</h2>
            <p style="color: #ccc; margin-bottom: 1rem;">Test image loading failure and fallback strategies</p>
            <button class="test-button" onclick="testImageError()">Test Image Error</button>
            <div class="portfolio-image loading" style="width: 200px; height: 150px; margin: 1rem 0;">
                <img id="test-image" data-src="invalid-image-url.jpg" alt="Test image">
            </div>
            <div id="test-image-results" class="test-results"></div>
        </div>
        
        <!-- Test Global Error -->
        <div class="test-section">
            <h2>Global Error Test</h2>
            <p style="color: #ccc; margin-bottom: 1rem;">Test global error boundary functionality</p>
            <button class="test-button" onclick="testGlobalError()">Trigger Global Error</button>
            <div id="test-global-results" class="test-results"></div>
        </div>
        
        <!-- Test Performance Monitoring -->
        <div class="test-section">
            <h2>Performance Monitoring Test</h2>
            <p style="color: #ccc; margin-bottom: 1rem;">Test performance monitoring and memory tracking</p>
            <button class="test-button" onclick="testPerformanceMonitoring()">Run Performance Test</button>
            <div id="test-performance-results" class="test-results"></div>
        </div>
        
        <!-- Test Network Retry -->
        <div class="test-section">
            <h2>Network Retry Test</h2>
            <p style="color: #ccc; margin-bottom: 1rem;">Test network-aware image loading with retry logic</p>
            <button class="test-button" onclick="testNetworkRetry()">Test Network Retry</button>
            <div id="test-retry-results" class="test-results"></div>
        </div>
    </div>

    <script src="js/artist-data.js"></script>
    <script src="js/main.js"></script>
    <script src="js/portfolio.js"></script>
    
    <script>
        // Test Functions
        function test404Error() {
            const results = document.getElementById('test-404-results');
            results.innerHTML = 'Testing 404 error handling...\n';
            
            try {
                // Simulate invalid artist slug
                const originalSlug = getCurrentArtistSlug;
                window.getCurrentArtistSlug = () => 'invalid-artist';
                
                // Try to initialize portfolio data
                initializePortfolioData();
                
                results.innerHTML += 'SUCCESS: 404 error handled gracefully\n';
                results.innerHTML += 'Check main content area for 404 error display\n';
                
                // Restore original function
                window.getCurrentArtistSlug = originalSlug;
                
            } catch (error) {
                results.innerHTML += `ERROR: ${error.message}\n`;
            }
        }
        
        function testImageError() {
            const results = document.getElementById('test-image-results');
            const testImage = document.getElementById('test-image');
            const container = testImage.parentElement;
            
            results.innerHTML = 'Testing image error handling...\n';
            
            try {
                // Test image loading with invalid URL
                handleImageLoadError(testImage, container, 'invalid-image-url.jpg');
                
                results.innerHTML += 'SUCCESS: Image error handled\n';
                results.innerHTML += 'Check image container for error state\n';
                
            } catch (error) {
                results.innerHTML += `ERROR: ${error.message}\n`;
            }
        }
        
        function testGlobalError() {
            const results = document.getElementById('test-global-results');
            results.innerHTML = 'Testing global error handling...\n';
            
            try {
                // Trigger a global error
                const testError = new Error('Test global error');
                handleGlobalError(testError, 'Test context');
                
                results.innerHTML += 'SUCCESS: Global error handled\n';
                results.innerHTML += 'Check for error notification in top-right corner\n';
                
            } catch (error) {
                results.innerHTML += `ERROR: ${error.message}\n`;
            }
        }
        
        function testPerformanceMonitoring() {
            const results = document.getElementById('test-performance-results');
            results.innerHTML = 'Testing performance monitoring...\n';
            
            try {
                PerformanceMonitor.measurePerformance();
                PerformanceMonitor.monitorMemory();
                
                results.innerHTML += 'SUCCESS: Performance monitoring executed\n';
                results.innerHTML += 'Check browser console for performance metrics\n';
                
            } catch (error) {
                results.innerHTML += `ERROR: ${error.message}\n`;
            }
        }
        
        function testNetworkRetry() {
            const results = document.getElementById('test-retry-results');
            results.innerHTML = 'Testing network retry logic...\n';
            
            try {
                const testImg = document.createElement('img');
                const testContainer = document.createElement('div');
                testContainer.className = 'portfolio-image loading';
                
                // Test with invalid URL to trigger retry logic
                loadImageWithRetry('invalid-url.jpg', testImg, testContainer)
                    .then(() => {
                        results.innerHTML += 'UNEXPECTED: Image loaded successfully\n';
                    })
                    .catch((error) => {
                        results.innerHTML += `SUCCESS: Retry logic executed - ${error.message}\n`;
                        results.innerHTML += 'Check browser console for retry attempts\n';
                    });
                
            } catch (error) {
                results.innerHTML += `ERROR: ${error.message}\n`;
            }
        }
        
        // Initialize test environment
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Error handling test page loaded');
            
            // Override console.error to capture test results
            const originalConsoleError = console.error;
            console.error = function(...args) {
                originalConsoleError.apply(console, args);
                
                // Log errors to test results if they contain test keywords
                const message = args.join(' ');
                if (message.includes('Test') || message.includes('ERROR')) {
                    const allResults = document.querySelectorAll('.test-results');
                    allResults.forEach(results => {
                        if (results.innerHTML.includes('Testing')) {
                            results.innerHTML += `CONSOLE: ${message}\n`;
                        }
                    });
                }
            };
        });
    </script>
</body>
</html>